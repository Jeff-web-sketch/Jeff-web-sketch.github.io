<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Pickle Type</title>
<style>
    body {
        background-color: #1b1b1b;
        color: white;
        font-family: monospace;
        text-align: center;
        padding: 20px;
    }
    header {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 10px;
        margin-bottom: 20px;
    }
    header img {
        width: 50px;
        height: 50px;
        border-radius: 50%;
    }
    #countdown {
        font-size: 2rem;
        margin-bottom: 20px;
    }
    #prompt {
        font-size: 1.5rem;
        max-width: 800px;
        margin: auto;
        line-height: 2rem;
    }
    .word {
        padding: 2px 4px;
        border-radius: 5px;
    }
    .current {
        background-color: yellow;
        color: black;
    }
    .wrong {
        background-color: red;
        color: white;
    }
    #stats {
        margin-top: 20px;
        font-size: 1.2rem;
    }
    #endScreen {
        display: none;
        margin-top: 40px;
    }
    button {
        padding: 10px 20px;
        font-size: 1rem;
        background: #4caf50;
        border: none;
        color: white;
        border-radius: 5px;
        cursor: pointer;
    }
</style>
</head>
<body>

<header>
    <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/6/6a/Dill_pickle.jpg/640px-Dill_pickle.jpg" alt="Pickle">
    <h1>Pickle Type</h1>
</header>

<div id="countdown">3</div>
<div id="prompt"></div>
<div id="stats">
    WPM: <span id="wpm">0</span> | Accuracy: <span id="accuracy">100</span>%
</div>

<div id="endScreen">
    <h2>Finished!</h2>
    <p>WPM: <span id="finalWpm"></span></p>
    <p>Accuracy: <span id="finalAccuracy"></span>%</p>
    <button onclick="startGame()">Play Again</button>
</div>

<script>
const prompts = [
    "Pickles are amazing when you put them on sandwiches with cheese, lettuce, tomato, and just the right amount of mayonnaise.",
    "Some people like sweet pickles, while others prefer sour dill pickles that have been brined for weeks in vinegar and spices.",
    "In a competitive pickle typing game, you must type fast and accurately to beat your previous record.",
    "Typing about pickles may seem strange, but it can be surprisingly fun and even make you crave a crunchy snack."
];

let words = [];
let currentWordIndex = 0;
let correctChars = 0;
let totalTypedChars = 0;
let startTime = null;
let timerInterval = null;

const countdownEl = document.getElementById('countdown');
const promptEl = document.getElementById('prompt');
const wpmEl = document.getElementById('wpm');
const accuracyEl = document.getElementById('accuracy');
const endScreen = document.getElementById('endScreen');
const finalWpmEl = document.getElementById('finalWpm');
const finalAccuracyEl = document.getElementById('finalAccuracy');

function startGame() {
    endScreen.style.display = 'none';
    countdownEl.style.display = 'block';
    promptEl.innerHTML = '';
    currentWordIndex = 0;
    correctChars = 0;
    totalTypedChars = 0;
    startTime = null;
    clearInterval(timerInterval);
    let count = 3;
    countdownEl.textContent = count;
    const countdownTimer = setInterval(() => {
        count--;
        countdownEl.textContent = count > 0 ? count : "GO!";
        if (count < 0) {
            clearInterval(countdownTimer);
            countdownEl.style.display = 'none';
            beginTyping();
        }
    }, 1000);
}

function beginTyping() {
    words = prompts[Math.floor(Math.random() * prompts.length)].split(' ');
    renderPrompt();
    currentWordIndex = 0;
    startTime = new Date();
    document.addEventListener('keydown', handleTyping);
    timerInterval = setInterval(updateStats, 100);
}

function renderPrompt() {
    promptEl.innerHTML = words.map((word, i) => {
        let classes = "word";
        if (i === currentWordIndex) classes += " current";
        return `<span class="${classes}">${word}</span>`;
    }).join(' ');
}

let currentInput = "";

function handleTyping(e) {
    if (!startTime) startTime = new Date();
    if (e.key.length === 1 && e.key !== " ") {
        currentInput += e.key;
        totalTypedChars++;
        checkCurrentWord();
    }
    if (e.key === " ") {
        if (currentInput.trim() === words[currentWordIndex]) {
            correctChars += words[currentWordIndex].length;
        }
        currentWordIndex++;
        currentInput = "";
        if (currentWordIndex >= words.length) {
            endGame();
        } else {
            renderPrompt();
        }
    }
}

function checkCurrentWord() {
    const currentWord = words[currentWordIndex];
    const wordEls = document.querySelectorAll(".word");
    if (currentWord.startsWith(currentInput)) {
        wordEls[currentWordIndex].classList.remove("wrong");
    } else {
        wordEls[currentWordIndex].classList.add("wrong");
    }
}

function updateStats() {
    const elapsedMinutes = (new Date() - startTime) / 60000;
    const wpm = Math.round((correctChars / 5) / elapsedMinutes);
    wpmEl.textContent = wpm;
    const accuracy = totalTypedChars > 0 ? Math.round((correctChars / totalTypedChars) * 100) : 100;
    accuracyEl.textContent = accuracy;
}

function endGame() {
    clearInterval(timerInterval);
    document.removeEventListener('keydown', handleTyping);
    finalWpmEl.textContent = wpmEl.textContent;
    finalAccuracyEl.textContent = accuracyEl.textContent;
    endScreen.style.display = 'block';
}
startGame();
</script>

</body>
</html>
