<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Pickle Type</title>
<style>
    body {
        background-color: #0e2d1b;
        color: #fff;
        font-family: monospace;
        text-align: center;
        margin: 0;
        padding: 20px;
    }
    h1 {
        color: #a8ff91;
    }
    #countdown {
        font-size: 2rem;
        margin-bottom: 20px;
    }
    #prompt {
        font-size: 1.5rem;
        max-width: 800px;
        margin: 20px auto;
        line-height: 2rem;
    }
    .word {
        padding: 3px;
        border-radius: 3px;
    }
    .current {
        background-color: #3c6e47;
    }
    .wrong {
        background-color: #ff4a4a;
    }
    .correct {
        background-color: #4aff6a;
        color: black;
    }
    #stats {
        margin-top: 20px;
        font-size: 1.2rem;
    }
    #endScreen {
        display: none;
        margin-top: 30px;
        background: #164d2f;
        padding: 20px;
        border-radius: 10px;
    }
    #endScreen h2 {
        margin: 0;
        color: #a8ff91;
    }
</style>
</head>
<body>

<h1>ðŸ¥’ Pickle Type ðŸ¥’</h1>
<div id="countdown"></div>
<div id="prompt"></div>
<div id="stats">
    WPM: <span id="wpm">0</span> | Accuracy: <span id="accuracy">100</span>%
</div>
<div id="endScreen">
    <h2>Race Finished!</h2>
    <p>Your WPM: <span id="finalWpm"></span></p>
    <p>Your Accuracy: <span id="finalAccuracy"></span>%</p>
</div>

<script>
const sentences = [
    "Pickles are life especially when typing as fast as you possibly can while imagining cucumbers turning into tasty crunchy green delights.",
    "Racing through sentences is like racing through a jar of pickles one word at a time crisp and satisfying with every correct keystroke.",
    "Some people like sweet pickles others like dill but everyone loves a challenge especially when it comes to fast accurate typing games."
];

let words = [];
let currentWordIndex = 0;
let startTime = null;
let typedChars = 0;
let correctChars = 0;
let countdownValue = 3;
let raceStarted = false;

const countdownDiv = document.getElementById('countdown');
const promptDiv = document.getElementById('prompt');
const wpmSpan = document.getElementById('wpm');
const accuracySpan = document.getElementById('accuracy');
const endScreen = document.getElementById('endScreen');
const finalWpm = document.getElementById('finalWpm');
const finalAccuracy = document.getElementById('finalAccuracy');

function loadPrompt() {
    const sentence = sentences[Math.floor(Math.random() * sentences.length)];
    words = sentence.split(" ");
    promptDiv.innerHTML = words.map((word, i) =>
        `<span class="word ${i === 0 ? 'current' : ''}">${word}</span>`
    ).join(" ");
}

function startCountdown() {
    countdownDiv.textContent = countdownValue;
    const interval = setInterval(() => {
        countdownValue--;
        if (countdownValue > 0) {
            countdownDiv.textContent = countdownValue;
        } else {
            clearInterval(interval);
            countdownDiv.textContent = "GO!";
            setTimeout(() => countdownDiv.textContent = "", 500);
            raceStarted = true;
            startTime = new Date();
        }
    }, 1000);
}

function updateStats() {
    const elapsedMinutes = (new Date() - startTime) / 60000;
    const wpm = Math.round((correctChars / 5) / elapsedMinutes);
    const accuracy = typedChars === 0 ? 100 : Math.round((correctChars / typedChars) * 100);
    wpmSpan.textContent = wpm;
    accuracySpan.textContent = accuracy;
}

document.addEventListener('keydown', (e) => {
    if (!raceStarted || e.key.length !== 1 && e.key !== " ") return;

    let currentWordElem = document.querySelectorAll('.word')[currentWordIndex];
    let currentWordText = words[currentWordIndex];

    if (!currentWordElem.dataset.progress) currentWordElem.dataset.progress = "";

    if (e.key === " ") {
        if (currentWordElem.dataset.progress.trim() === currentWordText) {
            currentWordElem.classList.remove("current", "wrong");
            currentWordElem.classList.add("correct");
        } else {
            currentWordElem.classList.remove("current");
            currentWordElem.classList.add("wrong");
        }
        currentWordIndex++;
        if (currentWordIndex >= words.length) {
            endRace();
            return;
        }
        document.querySelectorAll('.word').forEach(w => w.classList.remove("current"));
        document.querySelectorAll('.word')[currentWordIndex].classList.add("current");
    } else {
        typedChars++;
        currentWordElem.dataset.progress += e.key;
        if (currentWordElem.dataset.progress === currentWordText.substring(0, currentWordElem.dataset.progress.length)) {
            correctChars++;
            currentWordElem.classList.remove("wrong");
        } else {
            currentWordElem.classList.add("wrong");
        }
    }
    updateStats();
});

function endRace() {
    raceStarted = false;
    finalWpm.textContent = wpmSpan.textContent;
    finalAccuracy.textContent = accuracySpan.textContent;
    endScreen.style.display = "block";
}

loadPrompt();
startCountdown();
</script>

</body>
</html>
